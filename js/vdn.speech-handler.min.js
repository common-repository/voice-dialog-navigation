window.addEventListener("load",function(){let e=localStorage.getItem("vdnPendingPlaybackPath");null!=e&&(localStorage.setItem("vdnPendingPlaybackPath",""),void 0!==e&&e&&(vdnIntentResponsePlayer.configure(e),vdnIntentResponsePlayer.play()));let n=localStorage.getItem("vdnCtx");null!=n&&(vdnMyContext=JSON.parse(n),localStorage.setItem("vdnCtx","{}"));let t=localStorage.getItem("vdnStat");null!=t&&(vdnMyStatus=JSON.parse(t),localStorage.setItem("vdnStat","{}"))}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var vdnRespTimeOut=!1,vdnErrcnt=0,vdnMyStatus={},vdnMyContext={},vdnWin1=-1,vdnWin2=-1,vdnIsTalking=!1,vdnIsGtmPresent=!1;let vdnGtagConfigCount=0,vdnGaConfiguredForGtag=!1,vdnGoogleAnalyticsTrackingId="undefined"!=typeof vdnGaTrackingId?vdnGaTrackingId:null;if("undefined"!=typeof vdnGaTrack&&"yes"==vdnGaTrack)try{if("function"!=typeof ga||vdnGoogleAnalyticsTrackingId||ga(function(){vdnGoogleAnalyticsTrackingId=ga.getAll()[0].get("trackingId")}),void 0!==window.dataLayer){let e=window.dataLayer.length;for(let n=0;n<e;n++){let e=window.dataLayer[n];if(void 0!==e.event&&"gtm.js"===e.event){vdnIsGtmPresent=!0;break}"object"==typeof e&&Object.values(e).forEach(function(e,n){"config"===e&&(vdnGtagConfigCount+=1),void 0!==e.indexOf&&-1!==e.indexOf("UA-")&&(vdnGaConfiguredForGtag=!0)})}}}catch(e){console.log("VDN Google Analytics support detection error: "+e.message),vdnGtagConfigCount=0,vdnGaConfiguredForGtag=!1,vdnGoogleAnalyticsTrackingId=null}var vdnIntentResponsePlayer={htmlAudioElement:document.createElement("AUDIO"),lastFilePath:null,antiMuteButtonPlaybacks:[vdnSilenceSoundPath],isAntiMutePlayback:!1,configure:function(e=null,n=null){try{let t=void 0!==e&&e?e:null;t?(this.htmlAudioElement.src=vdnPathUrl+t,this.htmlAudioElement.preload="auto",this.lastFilePath=t,-1!==this.antiMuteButtonPlaybacks.indexOf(t)?this.isAntiMutePlayback=!0:this.isAntiMutePlayback=!1):(this.htmlAudioElement.src="",this.isAntiMutePlayback=!1),this.htmlAudioElement.onplay=function(){vdnIsTalking=!0}.bind(this),this.htmlAudioElement.onended=function(){vdnIsTalking=!1,this.htmlAudioElement.src="",this.muteButton("hide"),this.isAntiMutePlayback=!1,t&&"function"==typeof n&&(n(),n=null)}.bind(this),this.htmlAudioElement.onerror=function(){vdnIsTalking=!1,this.muteButton("hide"),this.isAntiMutePlayback=!1}.bind(this),this.htmlAudioElement.onplaying=function(){vdnIsTalking=!0,this.muteButton("show")}.bind(this)}catch(e){this.clear(),this.isAntiMutePlayback=!1}},play:function(){try{this.htmlAudioElement&&this.htmlAudioElement.src&&this.htmlAudioElement.play().catch(function(e){console.log("VDN Exception: Failed to play audio.")})}catch(e){this.clear()}},stop:function(){try{this.clear()}catch(e){this.clear()}},clear:function(){try{if(this.htmlAudioElement){let e=isNaN(this.htmlAudioElement.duration)?0:this.htmlAudioElement.duration;this.htmlAudioElement.currentTime=e}this.lastFilePath=null}catch(e){this.lastFilePath=null,this.isAntiMutePlayback=!1}this.muteButton("hide")},muteButton:function(e){try{if(this.isAntiMutePlayback||void 0===vdnResponseControllerEl||!vdnResponseControllerEl||void 0===e)return!1;"show"==e?vdnResponseControllerEl.classList.remove("vdn-hide-element"):(vdnResponseControllerEl.classList.add("vdn-hide-element"),this.isPlaying()&&this.stop())}catch(e){}},isPlaying:function(){return(isNaN(this.htmlAudioElement.currentTime)?0:this.htmlAudioElement.currentTime)<(isNaN(this.htmlAudioElement.duration)?0:this.htmlAudioElement.duration)}};let vdnResponseControllers=document.querySelectorAll("span.vdn-response-controller");if(void 0!==vdnResponseControllers&&null!=vdnResponseControllers&&vdnResponseControllers.length>0){let e=vdnResponseControllers.length;for(let n=0;n<e;n++)vdnResponseControllers[n].remove()}var vdnResponseControllerEl=document.createElement("span"),vdnResponseControllerPositionClass="vdn-response-controller-middle-right",vdnMicPos=vdnSelectedMicPosition?vdnSelectedMicPosition.toLowerCase():"middle right";switch(vdnMicPos){case"middle left":vdnResponseControllerPositionClass="vdn-response-controller-middle-left";break;case"top right":vdnResponseControllerPositionClass="vdn-response-controller-top-right";break;case"top left":vdnResponseControllerPositionClass="vdn-response-controller-top-left";break;case"bottom right":vdnResponseControllerPositionClass="vdn-response-controller-bottom-right";break;case"bottom left":vdnResponseControllerPositionClass="vdn-response-controller-bottom-left";break;default:vdnResponseControllerPositionClass="vdn-response-controller-middle-right"}vdnResponseControllerEl.setAttribute("class","vdn-response-controller vdn-hide-element "+vdnResponseControllerPositionClass);let vdnAudioMuteIcon=document.createElement("button");vdnAudioMuteIcon.setAttribute("type","button"),vdnAudioMuteIcon.setAttribute("class","vdn-speaker-icon"),vdnAudioMuteIcon.setAttribute("title","Mute Simon"),vdnAudioMuteIcon.onclick=function(){vdnIntentResponsePlayer.muteButton("hide")},vdnResponseControllerEl.appendChild(vdnAudioMuteIcon),document.body.appendChild(vdnResponseControllerEl);let vdnSettingsData="undefined"!=typeof vdnConfiguredSetting?vdnConfiguredSetting:null,vdnHostName="undefined"!=typeof vdnCurrentHostName?vdnCurrentHostName:null,vdnTypeOfDialog="undefined"!=typeof vdnDialogType&&null!==vdnDialogType?vdnDialogType.trim():"generic",vdnCustomEndpoint="undefined"!=typeof vdnCustomEndpointUrl&&null!==vdnCustomEndpointUrl?vdnCustomEndpointUrl:null;null!==vdnCustomEndpoint&&vdnCustomEndpoint.constructor===Array&&1==vdnCustomEndpoint.length&&(vdnCustomEndpoint=null),vdnTypeOfSearch="undefined"!=typeof vdnTypeOfSearch&&null!==vdnTypeOfSearch?vdnTypeOfSearch:"native";let vdnMale=!1===vdnVoiceType.female;function vdnGetCookie(e=null){try{if(null==e)return"";let n=e+"=",t=decodeURIComponent(document.cookie).split(";"),o=t.length;for(let e=0;e<o;e++){let o=t[e];for(;" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(n))return o.substring(n.length,o.length)}}catch(e){console.log("Something went wrong while getting cookie.")}return""}function vdnIsCustomDialogOpted(){let e=!1;try{"custom"==vdnTypeOfDialog&&null!==vdnCustomEndpoint&&0!=vdnCustomEndpoint.length&&(e=!0)}catch(e){console.log("Something went wrong while checking preference of dialog type.")}return e}function vdnCheckAndGetIntentFromSettings(e,n=null,t=null){let o=null,i={description:vdnMessages.unableToProcess,url:"",enabled:!1};o=i;try{if(void 0!==n&&null!=n&&(i.description=n),void 0!==t&&null!=t&&0!=t.length&&(t=i.url=t.trim()),0==vdnIsCustomDialogOpted()&&void 0!==e&&0!=e.length&&null!=vdnSettingsData&&e in vdnSettingsData){let n=vdnSettingsData[e],t="response"in n?n.response:null,o="url"in n?n.url:"";void 0!==t&&null!=t&&0!=t.length&&(i.description=t),void 0!==o&&null!=o&&0!=o.length&&(i.url=o.trim());let l=!1;if("enabled"in n){let e=n.enabled;l=!0===(l=null!=e)&&"enabled"==e.trim()}i.enabled=l}1==vdnIsCustomDialogOpted()&&(i.enabled=!0)}catch(e){i=o,console.log("Something went wrong while checking settings:"+e.message)}return new RegExp("^([a-z]+://|//)","i").test(i.url)||(0===i.url.indexOf("www.")?i.url="http://"+i.url:(i.url="/"==i.url.charAt(0)?i.url:"/"+i.url,i.url=vdnGetCurrentHostURL()+i.url)),i.description=i.description.trim(),i}function vdnStt(e,n,t){if(0==n){let e=Math.floor(10*Math.random()),n=vdnAlternativeResponse.randomLib;0==vdnRespTimeOut&&(vdnIntentResponsePlayer.configure(n[e]),vdnIntentResponsePlayer.play(),vdnRespTimeOut=!0,setTimeout(function(){vdnRespTimeOut=!1},6e3))}let o=vdnWebSocketUrl.url+vdnWebSocketUrl.tokenQs+vdnServiceKeys.iSTT+vdnWebSocketUrl.otherQs,i=new WebSocket(o);i.onopen=function(n){i.send(JSON.stringify({action:"start","content-type":"audio/wav",interim_results:!1,max_alternatives:3,smart_formatting:!0})),i.send(e),i.send(JSON.stringify({action:"stop"})),vdnLogServiceCall()},i.onclose=function(e){},i.onmessage=function(e){!function(e){let n=JSON.parse(e.data);if(null!=n.results){let e="",o=!1;for(let t in n.results)1==n.results[t].final&&(e+=n.results[t].alternatives[0].transcript,o=!0);vdnErrcnt=0,1!=o&&0!=n.results.length||("function"==typeof t&&t(e),i.close())}}(e)},i.onerror=function(n){!function(n){if(vdnErrcnt++,i.close(),"undefined"==typeof vdnXApiKey||null===vdnXApiKey)return;vdnErrcnt<2&&vdnRefreshVoiceServicesKeys().then(function(n){vdnServiceKeys.iSTT=n,vdnStt(e,!0,t)}).catch(function(e){alert(e)})}()}}function vdnLogWithGoogleAnalytics(e,n){try{if("undefined"==typeof vdnGaTrack||null==vdnGaTrack)return;if("yes"==vdnGaTrack){let t=!1,o="Voice Dialog Navigation - Conversation Log",i="[ USER QUERY:- "+e+" ] [ SIMON RESPONSE:- "+n+" ]";if(vdnIsGtmPresent&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"VoiceDialogNavigation-QueryResponse",vdnQueryResponse:i}),t=!0),!vdnGoogleAnalyticsTrackingId||-1===vdnGoogleAnalyticsTrackingId.indexOf("UA-"))throw"Unable to send VDN conversation log to Google Analytics due to unavaibility of the Google Analytics tracking Id.";if(!t&&"function"==typeof gtag&&vdnGtagConfigCount>0&&!0===vdnGaConfiguredForGtag){let e={event_category:o};if(vdnGtagConfigCount>1){if(!vdnGoogleAnalyticsTrackingId)throw'Multiple "gtag" configurations detected but Google Analytics tracking id is missing.';e.send_to=vdnGoogleAnalyticsTrackingId}gtag("event",i,e),t=!0}if(t||"function"!=typeof ga||(ga("send","event",o,i),t=!0),!t)throw"Supported Google Analytics library not available."}}catch(e){let n="string"==typeof e?e:e.message;console.log("VDN Google Analytics Log Process Error: "+n)}}function vdnSendDialog(e,n,t=null){if("undefined"==typeof vdnXApiKey||null===vdnXApiKey)return;if(void 0===e||null==e||""==e.trim())return;let o=window.location.href;console.log("Will send the URL: "+o+" to SimonAI as base URL"),vdnMyStatus.cUrl=o;let i={msg:e,context:vdnMyContext,status:vdnMyStatus};function l(n){try{if(null!==t){let o=null;null!=(o=localStorage.getItem("vdnChatHistory"))&&(t.chatConvoEl.innerHTML=""),t.userMsgEl.innerHTML=e,t.simonMsgEl.innerHTML=n,t.userMsgElWrapper.appendChild(t.userMsgEl),t.chatConvoEl.appendChild(t.userMsgElWrapper),t.chatConvoEl.appendChild(t.simonMsgEl),null==o?localStorage.setItem("vdnChatHistory",t.chatConvoEl.innerHTML):(o=o+" "+t.chatConvoEl.innerHTML,localStorage.setItem("vdnChatHistory",o),t.chatConvoEl.innerHTML=o),void 0!==t.chatConvoEl.scrollTop&&void 0!==t.chatConvoEl.scrollHeight&&(t.chatConvoEl.scrollTop=t.chatConvoEl.scrollHeight),t.expandCollapseHandle()}}catch(e){}}let s=JSON.stringify(i,null,!0),r=new XMLHttpRequest,a=((new Date).getTime(),{userQuery:"",simonResponse:""});r.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(this.responseText);if(void 0===t||!t)return void n(vdnAlternativeResponse.unableToProcess);t.description="undefined"!=t.description?t.description:"",t.url="undefined"!=t.url?t.url:"",vdnLogWithGoogleAnalytics(e,t.description),null!=typeof t.status&&(vdnMyStatus=t.status),null!=typeof t.context&&(vdnMyContext=t.context);let i=void 0!==vdnMyStatus.intent?vdnMyStatus.intent:null,s=vdnCheckAndGetIntentFromSettings(i,t.description,t.url.toLowerCase());if(t.description=s.description,t.url=s.url,0==s.enabled){n(vdnAlternativeResponse.disabledIntentResponse,null,!0);let t=vdnMessages.traditionalSearch;return l(t),a.userQuery=e,a.simonResponse=t,void localStorage.setItem("vdnWidgetConversation",JSON.stringify(a,null,!0))}if(t.description){let s=vdnAlternativeResponse.defaultDesc;if(vdnIsCustomDialogOpted()){let e=vdnGetExistingCustomDialogResponse(vdnVoiceAndLanguage,t.description);e?(s=void 0!==e.path&&e.path?e.path:vdnAlternativeResponse.defaultDesc,o()):vdnCustomDialogTtsOnTheFly(t.description).then(function(e){e&&(s=void 0!==e.path&&e.path?e.path:vdnAlternativeResponse.defaultDesc),o()}).catch(function(e){console.log("VDN Error: Something went wrong while TTS process for custom dialog."),o()})}else{let e=vdnGetGenericDialog(vdnVoiceAndLanguage,i),n=e.dialog,t=e.generateAudio;if(n&&!0===t){let e="option_name"in n&&n.option_name?n.option_name:null,t="response"in n&&n.response?n.response:null;t&&e&&vdnGenericDialogTtsOnTheFly(t,e).then(function(e){s=void 0!==e&&void 0!==e.path?e.path:vdnAlternativeResponse.defaultDesc,o()}).catch(function(e){console.log("VDN Error: Something went wrong while TTS process for generic dialog."),o()})}else{let e=n&&void 0!==n.intent_audio_response?n.intent_audio_response:{},t="path"in e&&e.path?e.path:null;t&&(s=t),o()}}function o(){if(l(t.description),a.userQuery=e,a.simonResponse=t.description,localStorage.setItem("vdnWidgetConversation",JSON.stringify(a,null,!0)),vdnClientInfo.ios||vdnClientInfo.android&&vdnClientInfo.firefox||vdnClientInfo.safari&&!vdnClientInfo.chrome&&!vdnClientInfo.firefox||vdnClientInfo.windows&&vdnClientInfo.firefox)n(s,function(){null==t.url||""==t.url||vdnUrlPointsToCurrentPage(t.url)?localStorage.removeItem("vdnWidgetConversation"):location.assign(t.url)});else if(null!=t.url&&""!=t.url){let e=vdnUrlIsPartOfCurrentDomain(t.url.toLowerCase());if(null==e)return n(s),localStorage.removeItem("vdnWidgetConversation"),void alert(vdnMessages.pageUnavailable);if(0==e){try{-1!=vdnWin1&&vdnWin1.close()}catch(e){console.log("We had an error. Error "+e.message)}vdnWin1=window.open(t.url,t.url),n(s),localStorage.removeItem("vdnWidgetConversation")}else{t.description;!function e(t){var o=null;if(vdnUrlPointsToCurrentPage(t))return n(s),void localStorage.removeItem("vdnWidgetConversation");let i=t,l=i.indexOf("#"),r=!1;if(l>-1&&(vdnUrlPointsToCurrentPage(i=i.substring(0,l))?console.log("We need to navigate within the same page"):r=!0),-1==t.indexOf("#")||1==r){if(!0===vdnIsTalking)return void(o=setTimeout(function(){e(t),clearInterval(o)},500));localStorage.setItem("vdnPendingPlaybackPath",s),localStorage.setItem("vdnCtx",JSON.stringify(vdnMyContext,null,!0)),localStorage.setItem("vdnStat",JSON.stringify(vdnMyStatus,null,!0)),void 0!==o&&null!=o&&clearInterval(o)}else n(s),localStorage.removeItem("vdnWidgetConversation");location.assign(t)}(t.url.trim())}}else n(s),localStorage.removeItem("vdnWidgetConversation");if(null!=t.url2&&""!=t.url2){try{-1!=vdnWin2&&vdnWin2.close()}catch(e){console.log("We had an error. Error "+e.message)}vdnWin2=window.open(t.url2,t.url2),localStorage.removeItem("vdnWidgetConversation")}}}}else 4==this.readyState&&200!=this.status&&vdnLogWithGoogleAnalytics(e,vdnMessages.callFailed)};try{var d=vdnSendDialogApiUrl;vdnIsCustomDialogOpted()&&(d=vdnCustomEndpoint),r.open("POST",d,!0),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Content-type","application/json"),r.setRequestHeader("Access-Control-Allow-Origin","*"),r.setRequestHeader("x-api-key",vdnXApiKey),r.send(s)}catch(e){return console.log("We had an error. Error:"+e.message),void localStorage.removeItem("vdnWidgetConversation")}}function vdnGetCurrentHostURL(){var e=null;try{if(void 0===window.location||void 0===window.location.hostname||void 0===window.location.protocol)return vdnGetHostName();e=window.location.protocol+"//"+window.location.hostname}catch(n){e=vdnGetHostName(),console.log("Something went wrong while discovering current domain.")}return e}function vdnGetHostName(){return vdnHostName}function vdnUrlIsPartOfCurrentDomain(e){let n=!1;try{if(null==e)return null;let t="";0===e.indexOf("http://")?t="http://":0===e.indexOf("https://")&&(t="https://");let o=0==t.length?0:t.length,i=e.substring(o),l=i.indexOf("/"),s=i;-1!=l&&(s=i.substring(0,l)),0===(s=t+s).indexOf(vdnGetCurrentHostURL())&&(n=!0)}catch(e){n=null,console.log("Something went wrong while checking URL.")}return n}function vdnUrlPointsToCurrentPage(e=null){var n=!1;try{if(null==e)return!0;var t=window.location.href;e=e.trim();var o=t[t.length-1];o="/"==o?o:null,0!=e.length&&e.indexOf("/")==e.length-1&&void 0!==o&&"/"!=o&&(t+="/"),t==e&&(n=!0)}catch(e){n=!0,console.log("Something went wrong while getting current full URL.")}return n}function vdnLogServiceCall(e=0){try{let n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let e=JSON.parse(this.responseText);vdnServiceLogs.updatedAt=e.updatedAt||vdnServiceLogs.updatedAt,vdnServiceLogs.currentValue=e.currentValue||vdnServiceLogs.currentValue,vdnServiceLogs.lastValue=e.lastValue||vdnServiceLogs.lastValue}},n.open("POST",vdnAjaxObj.ajax_url,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send("action=vdn_log_service_call&_ajax_nonce="+vdnAjaxObj.nonce+"&updateLastValue="+e)}catch(e){}}function vdnRefreshVoiceServicesKeys(){return new Promise(function(e,n){let t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState)if(200===this.status){let t=JSON.parse(this.response),o=void 0!==t.token?t.token:null;if(o)e(o);else{if(vdnSttLanguageContext.gcp.stt&&"gStt"in t&&t.gStt)return void e(t.gStt);n(vdnErrorLibrary.outOfService)}}else n(vdnErrorLibrary.outOfService)};let o="?action=vdn_refresh_access_keys&_ajax_nonce="+vdnAjaxObj.keys_nonce;t.open("GET",vdnAjaxObj.ajax_url+o,!0),t.onerror=function(e){n(vdnErrorLibrary.outOfService)},t.send(null)})}function vdnGcpStt(e){return new Promise(function(n,t){if(!(vdnSttLanguageContext.gcp.endPoint&&vdnSttLanguageContext.gcp.key&&vdnSttLanguageContext.gcp.langCode&&void 0!==e&&e))return void t(null);if(0==vdnErrcnt){let e=Math.floor(10*Math.random()),n=vdnAlternativeResponse.randomLib;vdnIntentResponsePlayer.configure(n[e]),vdnIntentResponsePlayer.play()}let o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==this.readyState)try{let e=JSON.parse(this.response);if(200===this.status){vdnErrcnt=0;let o=void 0!==e&&e instanceof Object&&"results"in e?e.results:[],i=o&&o.length>0&&o[0]instanceof Object?o[0]:{},l="alternatives"in i&&i.alternatives?i.alternatives:[],s=l.length>0&&l[0]instanceof Object?l[0]:{},r="transcript"in s&&s.transcript?s.transcript:null;void 0!==r&&r?n(r):t(null)}else{let o="error"in e?e.error:{},i="message"in o&&o.message?o.message.toLowerCase():"";vdnErrcnt<1&&i&&-1!==i.indexOf("api key")?(vdnErrcnt++,vdnRefreshVoiceServicesKeys().then(function(e){vdnSttLanguageContext.gcp.key=e,vdnGcpStt().then(function(e){e?n(e):(vdnErrcnt=0,t(null))}).catch(function(e){vdnErrcnt=0,t(null)})}).catch(function(e){alert(e),vdnErrcnt=0,t(null)})):(vdnErrcnt=0,t(null))}}catch(e){t(null)}},o.onerror=function(e){t(null)},o.open("POST",vdnSttLanguageContext.gcp.endPoint+vdnSttLanguageContext.gcp.qs.key+vdnSttLanguageContext.gcp.key,!0),o.setRequestHeader("Content-Type","application/json;charset=UTF-8");let i={config:{encoding:"ENCODING_UNSPECIFIED",languageCode:vdnSttLanguageContext.gcp.langCode,enableWordTimeOffsets:!1},audio:{content:e}};o.send(JSON.stringify(i,null,!0))})}function vdnFormatEmail(e=null){let n=e;try{if(e&&null!==e){let t=e.toLowerCase();n=t=t.replace(/dot/gi,".").replace(/at/gi,"@").replace(/underscore/gi,"_").replace(/dotcom/gi,".com").replace(/dotorg/gi,".org").replace(/dotnet/gi,".net").replace(/dotint/gi,".int").replace(/dotedu/gi,".edu").replace(/ /g,"")}}catch(t){n=e}return n}function vdnGetExistingCustomDialogResponse(e,n){let t=null;try{if("undefined"!=typeof vdnCustomResponses&&vdnCustomResponses&&void 0!==e&&e){let o=vdnCustomResponses.length;e=e.trim(),n=n.trim();for(let i=0;i<o;i++){let o=vdnCustomResponses[i],l=void 0!==o.response&&o.response?o.response.trim():null,s=void 0!==o.voice&&o.voice?o.voice.trim():null;if(l&&s&&(l===n&&e===s)){t=JSON.parse(JSON.stringify(o));break}}}}catch(e){t=null}return t}function vdnGetGenericDialog(e,n){this.existingDialog={dialog:{},generateAudio:!1};try{if(!(void 0!==vdnSettingsData&&vdnSettingsData&&void 0!==e&&e&&void 0!==n&&n))throw"VDN Error: Settings data or parameters are missing while checking generic dialog existence.";if(this.selectedVoice=e.trim(),this.intentName=n.trim(),this.dialog=this.intentName in vdnSettingsData?vdnSettingsData[this.intentName]:{},!(this.dialog&&Object.keys(this.dialog).length>0))throw"VDN Error: Dialog is missing while checking generic dialog existence.";this.existingDialog.dialog=JSON.parse(JSON.stringify(this.dialog));let t="response"in this.dialog&&this.dialog.response?this.dialog.response.trim():null,o="enabled"in this.dialog&&this.dialog.enabled?this.dialog.enabled.trim():null,i="intent_audio_response"in this.dialog&&this.dialog.intent_audio_response?this.dialog.intent_audio_response:{},l="voice"in i&&i.voice?i.voice.trim():null,s="path"in i&&i.path?i.path.trim():null;void 0===t||!t||void 0===o||!o||"enabled"!==o||void 0!==s&&s&&void 0!==l&&l&&l===this.selectedVoice||(this.existingDialog.generateAudio=!0)}catch(e){this.existingDialog={dialog:{},generateAudio:!1}}return this.existingDialog}function vdnCustomDialogTtsOnTheFly(e){return new Promise(function(n,t){if(void 0===e||!e)return void t(null);let o=new FormData;o.append("response_text",e),o.append("action","vdn_custom_dialog_text_to_speech"),o.append("_ajax_nonce",vdnAjaxObj.custom_dialog_nonce);let i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==this.readyState)if(200===this.status){let e=JSON.parse(this.response),o=void 0!==e.success&&!0===e.success,i=void 0!==e.data?e.data:null;if(i&&o){let e=void 0!==i.updated_collection?i.updated_collection:null,o=void 0!==i.custom_response?i.custom_response:null;e&&o?(vdnCustomResponses=e,n(o)):t(null)}else t(null)}else t(null)},i.onerror=function(e){t(vdnErrorLibrary.outOfService)};vdnAjaxObj.custom_dialog_nonce;i.open("POST",vdnAjaxObj.ajax_url,!0),i.send(o)})}function vdnGenericDialogTtsOnTheFly(e,n){return new Promise(function(t,o){if(void 0===e||!e||void 0===n||!n)return void o(null);let i=new FormData;i.append("dialog_text",e),i.append("dialog_op_name",n),i.append("user","tts"),i.append("action","vdn_generic_dialog_tts_on_the_fly"),i.append("_ajax_nonce",vdnAjaxObj.generic_dialog_nonce);let l=new XMLHttpRequest;l.onreadystatechange=function(){if(4==this.readyState)if(200===this.status){let e=JSON.parse(this.response),n=void 0!==e.success&&!0===e.success,i=void 0!==e.data?e.data:null;if(i&&n)if(void 0!==i.path&&i.path){let e=void 0!==i.updated_generic_dialogs?i.updated_generic_dialogs:null;e&&Object.keys(e).length>0&&(vdnSettingsData=e),t(i)}else o(null);else o(null)}else o(null)},l.onerror=function(e){o(vdnErrorLibrary.outOfService)},l.open("POST",vdnAjaxObj.ajax_url,!0),l.send(i)})}