window.onload=(e=>{!function(){"use strict";let e="undefined"!=typeof vdnDisableSearchMic&&"1"==vdnDisableSearchMic,t="undefined"!=typeof vdnDisableFormsMic&&"1"==vdnDisableFormsMic;function n(){try{window.vdnMicTimeoutIdentifier&&(clearTimeout(window.vdnMicTimeoutIdentifier),window.vdnMicTimeoutIdentifier=null)}catch(e){}}function i(){try{if(!1===vdnClientInfo.ios)return!1;window.vdnIosMicTimeoutIdentifier&&(clearTimeout(window.vdnIosMicTimeoutIdentifier),window.vdnIosMicTimeoutIdentifier=null)}catch(e){}}function o(e,t,n=!1){try{let i=e.classList||null,o=t.classList||null;if(!i||!o)return!1;!0===n?(i.add("vdn-hide-element"),o.remove("vdn-hide-element")):(i.remove("vdn-hide-element"),o.add("vdn-hide-element"))}catch(e){}}n(),i(),vdnTypeOfSearch="undefined"!=typeof vdnTypeOfSearch&&null!==vdnTypeOfSearch?vdnTypeOfSearch:"native";let d=["Ask about our company","Ask for opening hours"];vdnSearchableHints="undefined"!=typeof vdnSearchableHints&&null!==vdnSearchableHints?vdnSearchableHints:d,vdnSearchableHints.constructor!==Array&&(vdnSearchableHints=[]),0==vdnSearchableHints.length&&(vdnSearchableHints=d);let l=null,s=2e4;function r(e){return e=parseInt(e,10),isNaN(e)||null==e?0:e}function a(e=null,t=null){let n=!1;try{let i=document.querySelectorAll("button.voice-dialog-navigation-button");if(null==i||null==e)return n;let o=i.length;for(let t=0;t<o;t++){let o=i[t].className,d=i[t].getAttribute("id");if(void 0!==o&&""!=o.trim()&&(-1!=o.indexOf("listening")&&e!=d)){n=!0;break}}if(0==n&&null===t){let e=document.querySelector("#vdnWidgetMic");null!==e&&-1!=e.className.indexOf("listening")&&(n=!0)}}catch(e){n=!1}return n}function c(){let e="Ask about us.";try{let t=vdnSearchableHints.length,n=Math.floor(Math.random()*t),i=vdnSearchableHints[n];void 0!==i&&""!=i.trim()&&(e=i)}catch(t){e="Ask about us."}return e}"undefined"!=typeof vdnMicListenTimeoutDuration&&null!==vdnMicListenTimeoutDuration?(l=parseInt(vdnMicListenTimeoutDuration),l=isNaN(l)?8:l):l=8,l=(l=l<8?8:l)>20?20:l,l*=1e3;let v=document.querySelector("div#search-outer form input[type=text]"),u=document.querySelector("div#mobile-menu form input[type=text]");null!==v&&v.setAttribute("data-vdn-top-search-bar","true"),null!==u&&u.setAttribute("data-vdn-mobile-search-bar","true");let p=document.querySelectorAll("form"),g=["text","email","search"],m=null,f=null;[].forEach.call(p,function(d,v){try{let p=d.getAttribute("style"),h=null!=p&&""!=p.trim();p=h?p+";":"",d.setAttribute("style",p+"display: block !important"),d.classList.add("vdn-sanitize-form-wrapper");let b=!1;var u=!1;let y=d.getAttribute("role")||"",w=d.classList||"",A=d.querySelectorAll('input:not([type=hidden]):not([id=vdnWidgetSearch]):not([style*="none"]), button[type=submit], textarea:not([style*="none"])');("search"===y.toLowerCase()||w.contains("searchform")||w.contains("search_form")||w.contains("search-form")||w.contains("searchForm"))&&(b=!0),b&&!m&&(m=d),[].forEach.call(A,function(m,h){let y=null,w=m.getAttribute("type")||"",A=m.className||"",I=m.getAttribute("id")||null,R=m.tagName;I&&null!==I&&(I=I.toLowerCase()),A&&null!==A&&(A=A.toLowerCase());let C=!1;-1===A.indexOf("datepicker")&&-1===A.indexOf("date")&&"datepicker"!==I&&"date"!==I||(C=!0),-1===A.indexOf("datepicker")&&"datepicker"!==I&&-1!==A.search(/validat|candidat/gi)&&(C=!1),"text"===w&&-1!==A.search(/email/gi)&&(w="email");let P="textarea"===R.toLowerCase();if(g.includes(w)&&0==C||1==P)y=m;else if(!("submit"!=w.toLowerCase()||e&&t)){if(b&&!e){let e=m.querySelectorAll("img, svg");for(let t=0;t<e.length;t++){e[t].classList.add("vdn-hide-element")}}d.addEventListener("submit",function(t){if(1==u)return t.preventDefault(),!1;if(!0===b&&!e)try{if("native"!=vdnTypeOfSearch){if(t.preventDefault(),"undefined"==typeof vdnXApiKey||null===vdnXApiKey)return vdnIntentResponsePlayer.configure(vdnAlternativeResponse.unavailable),vdnIntentResponsePlayer.play(),!1;if(!vdnClientInfo.android){vdnIntentResponsePlayer.configure(vdnAlternativeResponse.basic),vdnIntentResponsePlayer.play();let e=this.querySelector("input.vd-navigation-mic-band"),t=e?e.value:"";vdnSendDialog(t,function(e,t=null,n=!1){"function"!=typeof t&&(t=function(){if(!0===n)try{d.submit()}catch(e){console.log("VDN: Something went wrong while submitting a form for native search.")}}),vdnIntentResponsePlayer.configure(e,t),vdnIntentResponsePlayer.play()})}}}catch(e){console.log("VDN Exception: Unable to submit the form due to: "+e.message)}},!1)}if(null===y)return!0;if(b){if(f||(f=y),e)return!1}else if(t)return!1;let L=document.createElement("button");L.setAttribute("type","button"),L.setAttribute("class","voice-dialog-navigation-button"),L.setAttribute("id","voice-dialog-navigation-button"+v+h);let M=document.createElement("img");M.setAttribute("src",vdnImagesPath+"vdn-mic.svg"),M.setAttribute("class","vdn-mic-image"),M.setAttribute("id","vdn-mic-img"+v+h),L.appendChild(M);let S=document.createElement("img");!0===vdnClientInfo.ios&&(S.setAttribute("src",vdnImagesPath+"vdn-mic-stop.svg"),S.setAttribute("class","vdn-stop-alert vdn-hide-element"),S.setAttribute("id","vdn-mic-stop"+v+h),L.appendChild(S));let T=r(y.offsetHeight),E=y.getAttribute("data-vdn-top-search-bar"),x=y.getAttribute("data-vdn-mobile-search-bar"),k=!1,H=!1;null!=E&&""!=E.trim()&&(k=!0,0==T&&(T=59)),null!=x&&""!=x.trim()&&(H=!0);let D=r(.8*T);0==r(D)&&(T=D=35);let N=r(.1*T);1!=H&&1!=k||(N+=20),!0===P&&(N=10,D=35);let W="top: "+N+"px; ";W+="height: "+D+"px !important; ",W+="width: "+D+"px !important; ",W+="z-index: 999 !important; margin-left: 3px !important; border-radius: 50% !important; border: 2px solid #ffff !important;",L.setAttribute("style",W);let O=document.createElement("div");O.setAttribute("style",p+"display: inline-block !important");let B=window.getComputedStyle(y);O.setAttribute("class","vd-navigation-mic-band"),O.setAttribute("onclick","return false"),O.style.width=B.width,y.insertAdjacentElement("beforebegin",O);let K=y.parentNode.nodeName;null!=K&&0!=K.length&&"form"!=(K=K.toLowerCase())&&(y.parentNode.style.zIndex=1),O.appendChild(y),y.insertAdjacentElement("beforebegin",L),y.setAttribute("style",p+"width: 100% !important"),y.classList.add("vd-navigation-mic-band"),d.setAttribute("style",p);let X,q="";if(1==k&&L.addEventListener("mousedown",function(e){return e.preventDefault(),!0},!1),"webkitSpeechRecognition"in window&&!0===vdnClientInfo.chrome){let e=new webkitSpeechRecognition;function F(){if(u=!1,!X)if(L.classList.remove("listening"),L.style.setProperty("color","white"),!0===b){let t=Math.floor(10*Math.random()),n=vdnAlternativeResponse.randomLib;vdnIntentResponsePlayer.configure(n[t],function(){e()}),vdnIntentResponsePlayer.play()}else e();function e(){if(void 0!==q&&0!=q.length){let e=q;"email"===w&&(e=vdnFormatEmail(e));let t=e&&null!==e?e:q;!0===P?y.value+=" "+t:y.value=t,!0===b&&vdnSendDialog(q,function(e,t=null,n=!1){"function"!=typeof t&&(t=function(){if(!0===n)try{d.submit()}catch(e){console.log("Something went wrong while submitting a form for native search.")}}),vdnIntentResponsePlayer.configure(e,t),vdnIntentResponsePlayer.play()})}else y.placeholder=vdnMessages.ask}}e.continuous=!0,e.interimResults=!0,e.onstart=function(){u=!0},e.onerror=function(e){L.classList.remove("listening"),u=!1,"no-speech"==e.error&&(y.placeholder=vdnMessages.unableToHear,vdnIntentResponsePlayer.configure(vdnAlternativeResponse.notAudible),vdnIntentResponsePlayer.play(),X=!0),"audio-capture"==e.error&&(y.placeholder=vdnMessages.micNotAccessible,X=!0),"not-allowed"==e.error&&(y.placeholder=vdnMessages.browserDenyMicAccess,L.style.setProperty("color","white"),X=!0)},e.onend=function(){vdnClientInfo.android&&F()},e.onresult=function(t){let n="";if(void 0===t.results)return e.onend=null,e.stop(),y.placeholder=vdnMessages.unableToHear,vdnIntentResponsePlayer.configure(vdnAlternativeResponse.micConnect),void vdnIntentResponsePlayer.play();let i=t.results.length;for(let o=t.resultIndex;o<i;++o)t.results[o].isFinal?(q=t.results[o][0].transcript,0==vdnClientInfo.android&&(F(),e.stop())):!1===P&&(n+=t.results[o][0].transcript,y.value=n)},L.addEventListener("click",function(t){if(!0!==a(L.getAttribute("id")))return"undefined"==typeof vdnXApiKey||null===vdnXApiKey?(vdnIntentResponsePlayer.configure(vdnAlternativeResponse.unavailable),void vdnIntentResponsePlayer.play()):void(u?(n(),!0===b&&(y.placeholder=c()),0==vdnClientInfo.android&&(F(),e.stop())):(!0===b&&(y.placeholder=c()),L.classList.add("listening"),t.preventDefault(),vdnIntentResponsePlayer.isPlaying()&&vdnIntentResponsePlayer.stop(),q="",!1===P&&(y.value=""),u=!0,e.lang=vdnSelectedLang,e.start(),X=!1,n(),window.vdnMicTimeoutIdentifier=setTimeout(function(){let e=L.classList;e&&e.contains("listening")&&L.click()},"textarea"==y.tagName.toLowerCase()?s:l)))})}else L.addEventListener("click",function(e){function t(){if("undefined"==typeof vdnXApiKey||null===vdnXApiKey)return vdnIntentResponsePlayer.configure(vdnAlternativeResponse.unavailable),vdnIntentResponsePlayer.play(),!1;if(u){if(n(),!0===vdnClientInfo.ios){i(),M.classList.contains("vdn-hide-element")&&o(M,S)}return vdnAudioRecorder.stop(),vdnStopAudio(),vdnIntentResponsePlayer.isPlaying()&&vdnIntentResponsePlayer.stop(),L.classList.remove("listening"),L.style.setProperty("color","white"),y.placeholder=vdnMessages.transcribeText,vdnAudioRecorder.getBuffers(function(e){vdnSttLanguageContext.gcp.stt&&vdnAudioRecorder.exportMonoWAV(function(e){vdnAudioRecorder.convertBlobToBase64(e).then(function(e){vdnGcpStt(e).then(function(e){if(void 0!==e&&0!=e.length){let t=e;"email"===w&&(t=vdnFormatEmail(t));let n=t&&null!==t?t:e;!0===P?y.value+=" "+n:y.value=n,!0===b&&vdnSendDialog(e,function(e,t=null,n=!1){"function"!=typeof t&&(t=function(){if(!0===n)try{d.submit()}catch(e){console.log("Something went wrong while submitting a form for native search.")}}),vdnIntentResponsePlayer.configure(e,t),vdnIntentResponsePlayer.play()})}else vdnIntentResponsePlayer.configure(vdnAlternativeResponse.notAudible),vdnIntentResponsePlayer.play(),y.placeholder=vdnMessages.ask})}).catch(function(e){vdnIntentResponsePlayer.configure(vdnAlternativeResponse.notAudible),vdnIntentResponsePlayer.play(),y.placeholder=vdnMessages.ask})})}),void(u=!1)}if(!0===b&&(y.placeholder=c()),L.classList.add("listening"),e.preventDefault(),vdnIntentResponsePlayer.isPlaying()&&vdnIntentResponsePlayer.stop(),q="",!1===P&&(y.value=""),u=!0,vdnAudioRecorder.clear(),vdnAudioRecorder.record(L,y.tagName),!0===vdnClientInfo.ios){i(),M.classList.contains("vdn-hide-element")||(window.vdnIosMicTimeoutIdentifier=setTimeout(function(){o(M,S,!0)},4e3))}n(),window.vdnMicTimeoutIdentifier=setTimeout(function(){let e=L.classList;e&&e.contains("listening")&&L.click()},"textarea"==y.tagName.toLowerCase()?s:l)}(!0===vdnClientInfo.ios||vdnClientInfo.safari&&!vdnClientInfo.chrome&&!vdnClientInfo.firefox||vdnClientInfo.windows&&vdnClientInfo.firefox)&&(vdnIntentResponsePlayer.configure(vdnSilenceSoundPath),vdnIntentResponsePlayer.play()),!0!==a(L.getAttribute("id"))&&(vdnAudioRecorder&&vdnAudioContext?t():vdnInitAudio(function(e){if(!vdnAudioRecorder||!vdnAudioContext)return alert(vdnMessages.micNotAccessible),!1;t()}))},!1);L.addEventListener("mouseover",function(e){!0===b&&(L.title=c())})})}catch(e){}});let h=document.createElement("div"),b="vdn-widget-wrapper-middle-right",y="vdn-widget-chat-wrapper-middle-right",w=vdnSelectedMicPosition?vdnSelectedMicPosition.toLowerCase():"middle right",A="vdn-widget-chat-wrapper-middle-right-collapse";switch(w){case"middle left":b="vdn-widget-wrapper-middle-left",y="vdn-widget-chat-wrapper-middle-left",A="vdn-widget-chat-wrapper-middle-left-collapse";break;case"top right":b="vdn-widget-wrapper-top-right",y="vdn-widget-chat-wrapper-top-right",A="vdn-widget-chat-wrapper-top-right-collapse";break;case"top left":b="vdn-widget-wrapper-top-left",y="vdn-widget-chat-wrapper-top-left",A="vdn-widget-chat-wrapper-top-left-collapse";break;case"bottom right":b="vdn-widget-wrapper-bottom-right",y="vdn-widget-chat-wrapper-bottom-right",A="vdn-widget-chat-wrapper-bottom-right-collapse";break;case"bottom left":b="vdn-widget-wrapper-bottom-left",y="vdn-widget-chat-wrapper-bottom-left",A="vdn-widget-chat-wrapper-bottom-left-collapse";break;default:b="vdn-widget-wrapper-middle-right",y="vdn-widget-chat-wrapper-middle-right",A="vdn-widget-chat-wrapper-middle-right-collapse"}h.setAttribute("class","vdn-widget-wrapper "+b);let I=document.createElement("div");I.setAttribute("class","vdn-widget-chat-wrapper "+A);let R=document.createElement("div");R.setAttribute("class","vdn-widget-chat-header");let C=document.createElement("div"),P=vdnVoiceType.female?"Simone":"Simon";C.setAttribute("class","vdn-widget-chat-option"),C.innerHTML='<div><img class="vdn-widget-chat-option-bot-icon" src="'+vdnImagesPath+'Voice Assistant Bot Icon.png"/></div><span class="vdn-widget-agent-name">'+P+'</b></span><br><span class="vdn-widget-agent">Web Virtual Assistant</span>';let L=document.createElement("span");L.setAttribute("class","vdn-expand-window vdn-expand-collapse-handle"),L.addEventListener("click",function(){ee()},!1),C.appendChild(L),R.appendChild(C);let M=document.createElement("div");M.setAttribute("id","vdnWidgetChatConvo"),M.setAttribute("class","vdn-widget-chat-convo vdn-hide-element");let S=document.createElement("span");S.setAttribute("class","vdn-widget-chat-msg-item vdn-widget-chat-msg-item-user");let T=document.createElement("div");T.setAttribute("class","vdn-widget-chat-avatar"),T.innerHTML="<center><b>"+vdnWidgetMessages.you+"</b></center>",S.appendChild(T);let E=document.createElement("span");S.appendChild(E);let x=document.createElement("span");x.setAttribute("class","vdn-widget-chat-msg-item vdn-widget-chat-msg-item-simon");let k=document.createElement("span");k.setAttribute("class","vdn-widget-chat-msg-item vdn-widget-chat-msg-error");let H=(vdnVoiceType.female?vdnWidgetMessages.simonIntro.name+"e":vdnWidgetMessages.simonIntro.name)+vdnWidgetMessages.simonIntro.intro+"<br/><br/>",D=vdnWidgetMessages.simonGuidelines,N=document.createElement("span");N.setAttribute("class","vdn-widget-chat-msg-item vdn-widget-chat-msg-item-simon"),N.innerHTML=H+D,M.appendChild(N);let W=document.createElement("div");W.setAttribute("class","vdn-widget-field");let O=document.createElement("a");O.setAttribute("id","vdnWidgetMic"),O.setAttribute("class","vdn-widget-button");let B=document.createElement("img");B.setAttribute("id","vdn-widget-mic-img"),B.setAttribute("src",vdnImagesPath+"vdn-widget-mic-black.svg"),O.appendChild(B);let K=document.createElement("img");!0===vdnClientInfo.ios&&(K.setAttribute("src",vdnImagesPath+"vdn-mic-stop.svg"),K.setAttribute("class","vdn-stop-alert vdn-hide-element"),K.setAttribute("id","vdn-mic-stop"),O.appendChild(K));let X=document.createElement("a");X.setAttribute("id","vdnWidgetSearchBtn");let q=document.createElement("button");q.setAttribute("class","vdn-widget-form-submit-btn"),q.setAttribute("type","submit"),q.setAttribute("alt","Go"),q.setAttribute("title","Search"),X.appendChild(q);let F=document.createElement("form");F.setAttribute("class","vdn-widget-form"),null!==m?(F.action=m.action,F.method=m.method):(F.action=vdnGetCurrentHostURL()+"/",F.method="get");let V=document.createElement("input");V.setAttribute("id","vdnWidgetSearch"),V.setAttribute("class","vdn-widget-search vdn-widget-search-text"),V.setAttribute("name","vdn-widget-search"),V.setAttribute("placeholder",vdnWidgetMessages.placeholder),V.setAttribute("name","s"),F.addEventListener("submit",function(e){try{M.removeChild(S)}catch(e){}try{M.removeChild(x)}catch(e){}try{M.removeChild(k)}catch(e){}if("native"!=vdnTypeOfSearch){if(e.preventDefault(),"undefined"==typeof vdnXApiKey||null===vdnXApiKey)return vdnIntentResponsePlayer.configure(vdnAlternativeResponse.unavailable),vdnIntentResponsePlayer.play(),!1;0!=V.value.length&&(vdnIntentResponsePlayer.configure(vdnAlternativeResponse.basic),vdnIntentResponsePlayer.play(),vdnSendDialog(V.value,function(e,t=null,n=!1){"function"!=typeof t&&(t=function(){if(!0===n)try{F.submit()}catch(e){console.log("Something went wrong while submitting a form for native search.")}}),vdnIntentResponsePlayer.configure(e,t),vdnIntentResponsePlayer.play()},Z()))}},!1),F.appendChild(V),F.appendChild(X),W.appendChild(O),W.appendChild(F),I.appendChild(R),I.appendChild(M),I.appendChild(W);let G=document.createElement("a");G.setAttribute("id","vdnWidgetToggleButton"),G.setAttribute("class","vdn-widget-button vdn-blink-widget-toggle-button");let j=vdnFloatingButtonIcon&&"robotIcon"==vdnFloatingButtonIcon?"vdn-toggle-btn-robot":"vdn-toggle-btn-mic",z=document.createElement("div");z.setAttribute("class","vdn-widget-icon vdn-widget-toggle-button "+j),G.appendChild(z),h.appendChild(I),h.appendChild(G),document.body.insertAdjacentElement("afterend",h),O.addEventListener("mouseover",function(e){O.title=c()}),G.addEventListener("click",function(e){!function(){null===localStorage.getItem("vdnSimonIntroduced")?(vdnIntentResponsePlayer.configure(vdnAlternativeResponse.simonShortIntro),vdnIntentResponsePlayer.play(),localStorage.setItem("vdnSimonIntroduced","yes")):-1!=z.className.indexOf(j)&&(N.innerHTML=D,void 0!==M.scrollTop&&void 0!==M.scrollHeight&&(M.scrollTop=M.scrollHeight));$(".vdn-widget-toggle-button",j),$(".vdn-widget-toggle-button","vdn-toggle-btn-close"),$(".vdn-widget-toggle-button","vdn-widget-active"),$(".vdn-widget-toggle-button","vdn-widget-visible"),$("#vdnWidgetToggleButton","vdn-widget-float"),$(".vdn-widget-chat-wrapper","vdn-widget-visible"),$(".vdn-widget-button","vdn-widget-visible"),null!==localStorage.getItem("vdnChatHistory")&&(document.getElementById("vdnWidgetChatConvo").innerHTML=localStorage.getItem("vdnChatHistory"));ee()}()}),document.body.onload=function(){let e=localStorage.getItem("vdnWidgetConversation");if(null!==e){let t=JSON.parse(e),n=t.userQuery||null,i=t.simonResponse||null;null!==n&&null!==i&&(G.classList.remove("vdn-blink-widget-toggle-button"),E.innerHTML=n,x.innerHTML=i,M.appendChild(S),M.appendChild(x),!1===vdnClientInfo.ios&&G.click()),ee("expand")}localStorage.removeItem("vdnWidgetConversation")};let U,J="",Q=!1,_="";if("webkitSpeechRecognition"in window&&!0===vdnClientInfo.chrome){let e=new webkitSpeechRecognition;function Y(){if(Q=!1,U)return;J=_,O.classList.remove("listening");let e=Math.floor(10*Math.random()),t=vdnAlternativeResponse.randomLib;vdnIntentResponsePlayer.configure(t[e],function(){void 0!==J&&0!=J.length?(E.innerHTML=J,M.appendChild(S),V.value=J,vdnSendDialog(J,function(e,t=null,n=!1){"function"!=typeof t&&(t=function(){if(!0===n)try{F.submit()}catch(e){console.log("Something went wrong while submitting a form for native search.")}}),vdnIntentResponsePlayer.configure(e,t),vdnIntentResponsePlayer.play()},Z())):V.placeholder=vdnMessages.ask}),vdnIntentResponsePlayer.play()}e.continuous=!0,e.interimResults=!0,e.onstart=function(){Q=!0},e.onerror=function(e){O.classList.remove("listening"),Q=!1,"no-speech"==e.error&&(vdnIntentResponsePlayer.configure(vdnAlternativeResponse.notAudible),vdnIntentResponsePlayer.play(),U=!0,k.innerHTML=vdnMessages.unableToHear,M.appendChild(k)),"audio-capture"==e.error&&(U=!0,k.innerHTML=vdnMessages.micNotAccessible,M.appendChild(k)),"not-allowed"==e.error&&(U=!0,k.innerHTML=vdnMessages.browserDenyMicAccess,M.appendChild(k))},e.onend=function(){vdnClientInfo.android&&Y()},e.onresult=function(t){let n="";if(void 0===t.results)return e.onend=null,e.stop(),V.placeholder=vdnMessages.unableToProcess,vdnIntentResponsePlayer.configure(vdnAlternativeResponse.unableToProcess),void vdnIntentResponsePlayer.play();let i=t.results.length;for(let o=t.resultIndex;o<i;++o)t.results[o].isFinal?(_=t.results[o][0].transcript,0==vdnClientInfo.android&&(Y(),e.stop())):n+=t.results[o][0].transcript},O.addEventListener("click",function(t){if(!0!==a(O.getAttribute("id"),O)){if("undefined"==typeof vdnXApiKey||null===vdnXApiKey)return vdnIntentResponsePlayer.configure(vdnAlternativeResponse.unavailable),void vdnIntentResponsePlayer.play();if(Q)n(),V.placeholder=c(),0==vdnClientInfo.android&&(Y(),e.stop());else{try{M.removeChild(S)}catch(e){}try{M.removeChild(x)}catch(e){}try{M.removeChild(k)}catch(e){}V.placeholder=c(),O.classList.add("listening"),t.preventDefault(),vdnIntentResponsePlayer.isPlaying()&&vdnIntentResponsePlayer.stop(),E.innerHTML=J="",Q=!0,e.lang=vdnSelectedLang,e.start(),U=!1,n(),window.vdnMicTimeoutIdentifier=setTimeout(function(){let e=O.classList;e&&e.contains("listening")&&O.click()},l)}}})}else O.addEventListener("click",function(e){function t(){if("undefined"==typeof vdnXApiKey||null===vdnXApiKey)return vdnIntentResponsePlayer.configure(vdnAlternativeResponse.unavailable),vdnIntentResponsePlayer.play(),!1;if(Q){if(n(),!0===vdnClientInfo.ios){i(),B.classList.contains("vdn-hide-element")&&o(B,K)}return vdnAudioRecorder.stop(),vdnStopAudio(),vdnIntentResponsePlayer.isPlaying()&&vdnIntentResponsePlayer.stop(),O.classList.remove("listening"),V.placeholder=vdnMessages.transcribeText,vdnAudioRecorder.getBuffers(function(e){vdnSttLanguageContext.gcp.stt&&vdnAudioRecorder.exportMonoWAV(function(e){vdnAudioRecorder.convertBlobToBase64(e).then(function(e){vdnGcpStt(e).then(function(e){void 0!==e&&0!=e.length?(E.innerHTML=e,M.appendChild(S),V.value=e,vdnSendDialog(e,function(e,t=null,n=!1){"function"!=typeof t&&(t=function(){if(!0===n)try{F.submit()}catch(e){console.log("Something went wrong while submitting a form for native search.")}}),vdnIntentResponsePlayer.configure(e,t),vdnIntentResponsePlayer.play()},Z())):(vdnIntentResponsePlayer.configure(vdnAlternativeResponse.notAudible),vdnIntentResponsePlayer.play(),V.placeholder=vdnMessages.ask)})}).catch(function(e){vdnIntentResponsePlayer.configure(vdnAlternativeResponse.notAudible),vdnIntentResponsePlayer.play(),V.placeholder=vdnMessages.ask})})}),void(Q=!1)}try{M.removeChild(S)}catch(e){}try{M.removeChild(x)}catch(e){}try{M.removeChild(k)}catch(e){}if(V.placeholder=c(),O.classList.add("listening"),e.preventDefault(),vdnIntentResponsePlayer.isPlaying()&&vdnIntentResponsePlayer.stop(),J="",Q=!0,vdnAudioRecorder.clear(),vdnAudioRecorder.record(O),!0===vdnClientInfo.ios){i(),B.classList.contains("vdn-hide-element")||(window.vdnIosMicTimeoutIdentifier=setTimeout(function(){o(B,K,!0)},4e3))}n(),window.vdnMicTimeoutIdentifier=setTimeout(function(){let e=O.classList;e&&e.contains("listening")&&O.click()},l)}(!0===vdnClientInfo.ios||vdnClientInfo.safari&&!vdnClientInfo.chrome&&!vdnClientInfo.firefox||vdnClientInfo.windows&&vdnClientInfo.firefox)&&(vdnIntentResponsePlayer.configure(vdnSilenceSoundPath),vdnIntentResponsePlayer.play()),!0!==a(O.getAttribute("id"),O)&&(vdnAudioRecorder&&vdnAudioContext?t():vdnInitAudio(function(e){if(!vdnAudioRecorder||!vdnAudioContext){try{M.removeChild(k)}catch(e){}return k.innerHTML=vdnMessages.micNotAccessible,M.appendChild(k),!1}t()}))},!1);function Z(){return{chatConvoEl:M,userMsgElWrapper:S,userMsgEl:E,simonMsgEl:x,errorMsgEl:k,expandCollapseHandle:function(){ee("expand")}}}function $(e,t){if(void 0===e||null==e||0==e.length)return!1;let n=document.querySelector(e);if(n.classList)n.classList.toggle(t);else{let e=n.className.split(" "),i=e.indexOf(t);i>=0?e.splice(i,1):(e.push(t),n.className=e.join(" "))}}function ee(e=null){try{if(!M)return!1;let t=M.classList,n=L.classList,i=I.classList;"expand"==e?(t.contains("vdn-hide-element")&&t.remove("vdn-hide-element"),n.contains("vdn-expand-window")&&(n.add("vdn-collapse-window"),n.remove("vdn-expand-window")),i.contains(A)&&(i.remove(A),i.add(y))):(t.toggle("vdn-hide-element"),n.toggle("vdn-expand-window"),n.toggle("vdn-collapse-window"),i.toggle(y),i.toggle(A)),M.scrollTop=M.scrollHeight}catch(e){console.log("VDN Error: something went wrong while expanding/collapsing a chat window.")}}O.addEventListener("mouseover",function(e){O.title=c()})}()});